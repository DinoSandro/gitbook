# Golden gMSA

The gMSA password is generated by leveraging a secret stored in KDS root key object. To compute the Group Key Envelope (GKE) the following attributes are needed fro the KDS root:

* cn
* msKds-SecretAgreementParam&#x20;
* msKds-RootKeyData&#x20;
* msKds-KDFParam&#x20;
* msKds-KDFAlgorithmID&#x20;
* msKds-CreateTime&#x20;
* msKds-UseStartTime&#x20;
* msKds-Version&#x20;
* msKds-DomainID&#x20;
* msKds-PrivateKeyLength&#x20;
* msKds-PublicKeyLength&#x20;
* msKds-SecretAgreementAlgorithmID

Once the GKE is computed you can generate the password offline

## References

{% embed url="https://www.semperis.com/blog/golden-gmsa-attack/" %}
